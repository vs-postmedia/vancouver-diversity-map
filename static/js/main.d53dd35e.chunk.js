(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e){e.exports={version:8,name:"Basic",metadata:{"mapbox:autocomposite":!0},sources:{mapbox:{url:"mapbox://mapbox.mapbox-streets-v7",type:"vector"}},sprite:"mapbox://sprites/mapbox/basic-v8",glyphs:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",paint:{"background-color":"#dedede"},interactive:!0},{id:"landuse_overlay_national_park",type:"fill",source:"mapbox","source-layer":"landuse_overlay",filter:["==","class","national_park"],paint:{"fill-color":"#d2edae","fill-opacity":.75},interactive:!0},{id:"landuse_park",type:"fill",source:"mapbox","source-layer":"landuse",filter:["==","class","park"],paint:{"fill-color":"#d2edae"},interactive:!0},{id:"waterway",type:"line",source:"mapbox","source-layer":"waterway",filter:["all",["==","$type","LineString"],["in","class","river","canal"]],paint:{"line-color":"#a0cfdf","line-width":{base:1.4,stops:[[8,.5],[20,15]]}},interactive:!0},{id:"water",type:"fill",source:"mapbox","source-layer":"water",paint:{"fill-color":"#a0cfdf"},interactive:!0},{id:"building",type:"fill",source:"mapbox","source-layer":"building",paint:{"fill-color":"#d6d6d6"},interactive:!0},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["==","structure","tunnel"]]],type:"line",source:"mapbox",id:"tunnel_minor",paint:{"line-color":"#efefef","line-width":{base:1.55,stops:[[4,.25],[20,30]]},"line-dasharray":[.36,.18]},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["==","structure","tunnel"]]],type:"line",source:"mapbox",id:"tunnel_major",paint:{"line-color":"#fff","line-width":{base:1.4,stops:[[6,.5],[20,30]]},"line-dasharray":[.28,.14]},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["in","structure","none","ford"]]],type:"line",source:"mapbox",id:"road_minor",paint:{"line-color":"#efefef","line-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["in","structure","none","ford"]]],type:"line",source:"mapbox",id:"road_major",paint:{"line-color":"#fff","line-width":{base:1.4,stops:[[6,.5],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_minor case",paint:{"line-color":"#dedede","line-width":{base:1.6,stops:[[12,.5],[20,10]]},"line-gap-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"butt","line-join":"miter"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_major case",paint:{"line-color":"#dedede","line-width":{base:1.6,stops:[[12,.5],[20,10]]},"line-gap-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway_link","street","street_limited","service","track","pedestrian","path","link"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_minor",paint:{"line-color":"#efefef","line-width":{base:1.55,stops:[[4,.25],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["in","class","motorway","primary","secondary","tertiary","trunk"],["==","structure","bridge"]]],type:"line",source:"mapbox",id:"bridge_major",paint:{"line-color":"#fff","line-width":{base:1.4,stops:[[6,.5],[20,30]]}},"source-layer":"road"},{interactive:!0,layout:{"line-cap":"round","line-join":"round"},filter:["all",["==","$type","LineString"],["all",["<=","admin_level",2],["==","maritime",0]]],type:"line",source:"mapbox",id:"admin_country",paint:{"line-color":"#8b8a8a","line-width":{base:1.3,stops:[[3,.5],[22,15]]}},"source-layer":"admin"},{interactive:!0,minzoom:5,layout:{"icon-image":"{maki}-11","text-offset":[0,.5],"text-field":"{name_en}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-max-width":8,"text-anchor":"top","text-size":11,"icon-size":1},filter:["all",["==","$type","Point"],["all",["==","scalerank",1],["==","localrank",1]]],type:"symbol",source:"mapbox",id:"poi_label",paint:{"text-color":"#666","text-halo-width":1,"text-halo-color":"rgba(255,255,255,0.75)","text-halo-blur":1},"source-layer":"poi_label"},{interactive:!0,layout:{"symbol-placement":"line","text-field":"{name_en}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-transform":"uppercase","text-letter-spacing":.1,"text-size":{base:1.4,stops:[[10,8],[20,14]]}},filter:["all",["==","$type","LineString"],["in","class","motorway","primary","secondary","tertiary","trunk"]],type:"symbol",source:"mapbox",id:"road_major_label",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":2},"source-layer":"road_label"},{interactive:!0,minzoom:8,layout:{"text-field":"{name_en}","text-font":["Open Sans Semibold","Arial Unicode MS Bold"],"text-max-width":6,"text-size":{stops:[[6,12],[12,16]]}},filter:["all",["==","$type","Point"],["in","type","town","village","hamlet","suburb","neighbourhood","island"]],type:"symbol",source:"mapbox",id:"place_label_other",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":1,"text-halo-blur":1},"source-layer":"place_label"},{interactive:!0,layout:{"text-field":"{name_en}","text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-max-width":10,"text-size":{stops:[[3,12],[8,16]]}},maxzoom:16,filter:["all",["==","$type","Point"],["==","type","city"]],type:"symbol",source:"mapbox",id:"place_label_city",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":1,"text-halo-blur":1},"source-layer":"place_label"},{interactive:!0,layout:{"text-field":"{name_en}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-max-width":10,"text-size":{stops:[[3,14],[8,22]]}},maxzoom:12,filter:["==","$type","Point"],type:"symbol",source:"mapbox",id:"country_label",paint:{"text-color":"#666","text-halo-color":"rgba(255,255,255,0.75)","text-halo-width":1,"text-halo-blur":1},"source-layer":"country_label"}]}},32:function(e,t,a){e.exports=a(48)},40:function(e,t,a){},41:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(12),o=a.n(i),l="pk.eyJ1IjoibmdyaWZmaXRocy1wb3N0bWVkaWEiLCJhIjoiY2p6MDkyYXgzMDM5ZjNvbHYxeWo5ZjR6aSJ9.hjWwvvVEkKcPm_mXyW4-Uw",s=a(5),c=a(4),p=a(8),u=a(7),d=a(9),m=a(20),y=a(13),h=a(10),b=a(31),f=a(29),v=a(30),x=(a(40),function(e){var t=e.settings,a=t.legendColors,n=t.thresholds,i=t.currentView;return r.a.createElement("div",{className:"legend"},r.a.createElement("h4",null,"Reported ".concat(i," origins")),r.a.createElement("div",{className:"color-bar"},n.map(function(e,t){return r.a.createElement("div",{className:"swatch",key:t,style:{backgroundColor:a[t],border:"1px solid #FFFFFF",height:"10px",width:"30px"}},r.a.createElement("p",{className:"legend-label"},"".concat(Math.floor(e),"%")))})))}),g=(a(41),function(e){var t=e.children;return r.a.createElement("div",{className:"control-panel"},t)}),w=function(e){function t(){return Object(s.a)(this,t),Object(p.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.containerComponent||g,a=this.props.settings,n=a.displayPopulations.map(function(e){return{value:e,label:e}});return n.sort(function(e,t){return e.label>t.label?1:-1}),r.a.createElement(t,null,r.a.createElement(v.a,{defaultValue:{label:a.currentView,value:a.currentView},isClearable:!0,isSearchable:!0,options:n,onChange:function(t){return e.props.onChange(t)}}),r.a.createElement(x,{settings:a}))}}]),t}(n.PureComponent),_=a(28),k=Object(y.a)({id:"data",source:"population",type:"fill",interactive:!0,paint:{"fill-color":{property:"percentile",stops:[[1,"#A7A9AB"],[2,"#f1eef6"],[3,"#d0d1e6"],[4,"#a6bddb"],[5,"#74a9cf"],[6,"#2b8cbe"],[7,"#045a8d"]]},"fill-opacity":.8,"fill-outline-color":"#FFFFFF"}}),S=Object(y.a)(_),j=(a(43),function(e){var t=e.currentView,a=e.hoveredFeature,n=e.x,i=e.y,o=a.properties,l=["GeoUID","Population","percent","percentile","Asian","African","Oceanian","North American","European","Central/South American"],s=Object.keys(o).map(function(e,t){if(!l.includes(e))return[e,o[e]]}).sort(function(e,t){return t[1]-e[1]}).slice(0,5);return r.a.createElement("div",{className:"tooltip",style:{left:n,top:i-50}},r.a.createElement("h1",{className:"current-percent"},"".concat(parseFloat(a.properties[t]).toFixed(1),"%")),r.a.createElement("p",{className:"current-view"},"Report ".concat(t," origins")),r.a.createElement("hr",null),r.a.createElement("h4",null,"Top reported origins:"),s.map(function(e,t){var a=parseFloat(e[1]).toFixed(1),n={backgroundColor:"steelblue",display:"inline-block",height:"15px",width:"".concat(a,"px")};return r.a.createElement("div",{className:"percent-results",key:t},r.a.createElement("p",{className:"group"},"".concat(e[0].split("/")[0],":")," "),r.a.createElement("div",{className:"bar-container"},r.a.createElement("div",{className:"bar",style:n}),r.a.createElement("p",{className:"percent-text"},"".concat(a,"%"))))}))}),E={dataUrl:"./data/choropleth-data-selectpops.geojson",colors:["#A7A9AB","#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],thresholds:[.1,5,10,25,35,50,75],displayPopulations:["Filipino","Iranian","Indian","Chinese","Korean","Japanese","Central","British Isles","First Nations/M\xe9tis/Inuit"],displayPopulations_top15:["Chinese","English","Scottish","Canadian","Irish","Indian","German","French","Filipino","Ukranian","Italian","Dutch","Polish","Russian","Korean"],displayPopulations_select:["Chinese","English","Scottish","Irish","Indian","German","French","Filipino","Ukranian","Italian","Dutch","Korean","Iranian","First Nations/M\xe9tis/Inuit"]},F=(a(44),a(45),function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={mapStyle:S,colorStops:[],currentView:"Indian",data:null,displayPopulations:E.displayPopulations_select,hoveredFeature:null,legendColors:E.colors,thresholds:E.thresholds,viewport:{latitude:49.228833,longitude:-122.922978,zoom:9,bearing:0,pitch:0}},a._loadData=function(e){var t=a.state.currentView;a._updateCurrentDisplayData(e,t);var n=S.setIn(["sources","population"],Object(y.a)({type:"geojson",data:e})).set("layers",S.get("layers").insert(15,a.state.colorStops));a.setState({data:e,mapStyle:n})},a._updateCurrentDisplayData=function(e,t){e.features.forEach(function(e){var n=e.properties[t];e.properties.percent=n,e.properties.percentile=a.scale(n)})},a._updateSettings=function(e){var t=a.state,n=t.data,r=t.mapStyle;if(e){a._updateCurrentDisplayData(n,e.value);var i=r.setIn(["sources","population","data"],Object(y.a)(n));a.setState({currentView:e.value,mapStyle:i})}},a._onViewportChange=function(e){return a.setState({viewport:e})},a._onHover=function(e){var t=e.features,n=e.srcEvent,r=n.offsetX,i=n.offsetY,o=t&&t.find(function(e){return"data"===e.layer.id});a.setState({hoveredFeature:o,x:r,y:i})},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(b.a)(E.dataUrl,function(t,a){t?console.log(t):(e.setState({displayPopulations:e._buildMenu(a.features[0].properties)}),e._loadData(a))}),this.scale=Object(f.a)().domain(this.state.thresholds).range(Object(h.e)(this.state.thresholds.length+1));var t=E.colors.map(function(e,t){return[t,e]});this.setState({colorStops:k.setIn(["paint","fill-color","stops"],Object(y.a)(t))})}},{key:"_buildMenu",value:function(e){var t=["GeoUID","Population"],a=[];for(var n in e)t.includes(n)||a.push(n);return a}},{key:"_renderTooltip",value:function(){var e=this.state,t=e.hoveredFeature,a=e.x,n=e.y;return t&&r.a.createElement(j,{hoveredFeature:t,currentView:this.state.currentView,x:a,y:n})}},{key:"render",value:function(){var e=this.state,t=e.viewport,a=e.mapStyle;return r.a.createElement("div",{style:{height:"100%",position:"relative"}},r.a.createElement(m.c,Object.assign({},t,{width:"100%",height:"100%",mapStyle:a,onViewportChange:this._onViewportChange,mapboxApiAccessToken:this.props.api_key,onHover:this._onHover}),r.a.createElement(m.a,{positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),r.a.createElement(m.b,{showCompass:!1}),this._renderTooltip()),r.a.createElement(w,{settings:this.state,onChange:this._updateSettings}))}}]),t}(n.Component));a(46);var O=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",null,r.a.createElement("h1",null,"The places we come from"),r.a.createElement("p",null,"The map below highlights the distribution of several of the most common responses in the Lower Mainland to the question of ethnic origin on the 2016 census.")),r.a.createElement(F,{api_key:l}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(47);o.a.render(r.a.createElement(O,null),document.getElementById("map")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[32,1,2]]]);
//# sourceMappingURL=main.d53dd35e.chunk.js.map